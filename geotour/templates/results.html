<!DOCTYPE html>

{% load staticfiles  %}

<html>
    <head>
        <link rel="stylesheet" type="text/css" href="{% static "style.css" %}">
        <link rel="stylesheet" type="text/css" href="{% static "results.css" %}">
        <title>Plan a Day</title>
        <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
        <script src="{% static "results.js" %}"></script>
        <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
    <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css"/>
        <script type="text/javascript">
            function filter() {
                var data = {'tourId':'{{tourId}}'};
                data += $('#areasForm').serialize();
                $.post('{% url "geotour:change" %}', data, function(htmlResponse) {
                    var element = document.getElementById('fill_in');
                    element.innerHTML = htmlResponse;
                });
            }
        </script>
    </head>

    <body>
        <div id="topBanner">Mini LOGO</div>
        <div id="gMapsPanel">HI</div>
        <div id="gMapsDiv"></div>
        <div id="miniNavBar">
            Test
            <img src="{% static 'images/gmaps.png' %}" id="gMapsIcon">
        </div>
        <div id="main">

            {% include 'timeline.html' %}


        <script type="text/javascript">
            $('.list-left').sortable({
                connectWith: '.list-right',
            });

            $('.list-right').sortable({
                receive: function(event, ui) {
                    /* save to database */
                    /* send tour id, list of places */
                    places = []
                    durations = []
                    $('.list-right .place').each(function(index) {
                        places.push(this.id);
                        alert(this.style.width/100.0)
                        durations.push(this.style.width/100.0);
                    });
                    data = {'tourId' : {{tourId}}, 'places' : places, 'durations' : durations}
                    // $.post('{% url "geotour:update" %}', data, function(htmlResponse) {

                    // });
                    $('.list-right .place').resizable({ handles: "s" });
                }
            });

            $('.list-right .place').resizable({ handles: "s", 
                stop: function(event, ui) {
                    places = []
                    durations = []
                    $('.list-right .place').each(function(index) {
                        places.push(this.id);
                        alert(this.id)
                        alert(this.style.width/100.0)
                        durations.push(this.style.width/100.0);
                    });
                    data = {'tourId' : {{tourId}}, 'places' : places, 'durations' : durations}
                    // $.post('{% url "geotour:update" %}', data, function(htmlResponse) {
                    // });
                }
            });

            $('#gMapsIcon').click(function() {
                $("#gMapsPanel").toggle();
                $("#gMapsDiv").toggle();
            })
        </script>
        </div>
    </body>
</html>
